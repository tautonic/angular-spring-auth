/**
 * AngularJS directives and filters for Pykl Studios
 * @version v1.0.0 - 2012-09-17
 * @link https://github.com/pykl/angular-comps
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("pykl.config",[]).value("pykl.config",{}),angular.module("pykl.filters",["pykl.config"]),angular.module("pykl.directives",["pykl.config"]),angular.module("pykl",["pykl.directives","pykl.config"]),angular.module("pykl.directives").directive("pyklEmailValidator",["pykl.config","$http",function(a,b){return"use strict",a.asyncEmail=a.asyncEmail||{},{require:"ngModel",link:function(c,d,e,f){f.$parsers.unshift(function(c){b.get(a.asyncEmail.url+c).success(function(a){return console.log(a),a==="true"?(f.$setValidity("pyklEmailValidator",!0),c):(f.$setValidity("pyklEmailValidator",!1),undefined)}).error(function(a,b){console.log(b)})})}}}]),angular.module("pykl.directives").directive("pyklUpload",["pykl.config",function(a){return"use strict",a.upload=a.upload||{},{restrict:"A",link:function(b,c,d){function g(a){return document.getElementById(a)}var e={},f={container:"container",max_file_size:"10mb",url:"/gc/api/profiles/pics/1",resize:{width:320,height:240,quality:90},flash_swf_url:"../js/plupload.flash.swf",silverlight_xap_url:"../js/plupload.silverlight.xap",filters:[{title:"Image files",extensions:"jpg,gif,png"},{title:"Zip files",extensions:"zip"}]};d.pyklUpload&&(e=b.$eval(d.pyklUpload),e.dropTarget&&(f.drop_element=e.dropTarget)),f=angular.extend({},f,a.upload);var h=new plupload.Uploader(f);h.bind("FilesAdded",function(a,b){for(var c in b)g("filelist").innerHTML+='<div id="'+b[c].id+'">'+b[c].name+" ("+plupload.formatSize(b[c].size)+") <b></b></div>";setTimeout(function(){h.start()},500)}),h.bind("UploadProgress",function(a,b){g(b.id).getElementsByTagName("b")[0].innerHTML="<span>"+b.percent+"%</span>"}),h.bind("FileUploaded",function(a,b,c){console.log(a,b,c),g(f.drop_element).src=c.response}),h.init()}}}]);